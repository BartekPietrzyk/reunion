<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zjazd Przyjaciół - Planer Miejscówki i Ankiety</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f5f5f4;
            font-family: 'Inter', sans-serif;
        }
        .region-btn.active, .vote-btn.active, .date-btn.active, .price-btn.active, .type-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #2563eb;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // Wklej tutaj swój własny kod konfiguracyjny z Firebase
            // Import the functions you need from the SDKs you need

        import { initializeApp } from "firebase/app";

        import { getAnalytics } from "firebase/analytics";

        // TODO: Add SDKs for Firebase products that you want to use

        // https://firebase.google.com/docs/web/setup#available-libraries


        // Your web app's Firebase configuration

        // For Firebase JS SDK v7.20.0 and later, measurementId is optional

        const firebaseConfig = {

        apiKey: "AIzaSyDTD7_FDYkWoaJzRsnSf2HtKTB6iI5kPw8",

        authDomain: "spot2-9c20c.firebaseapp.com",

        projectId: "spot2-9c20c",

        storageBucket: "spot2-9c20c.firebasestorage.app",

        messagingSenderId: "140489256855",

        appId: "1:140489256855:web:659f7c8f1dbf5831a11ed2",

        measurementId: "G-W1N8GHPL53"

        };


        // Initialize Firebase

        const app = initializeApp(firebaseConfig);

        const analytics = getAnalytics(app);

    </script>
</head>
<body class="font-sans text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-5xl">

        <div class="flex flex-col items-center mb-8">
            <div class="w-full flex justify-end mb-4">
                <div class="flex items-center space-x-2">
                    <input type="password" id="secret-code-input" class="w-24 p-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Kod">
                    <button id="show-stats-btn" class="p-1 text-sm bg-gray-200 rounded-md hover:bg-gray-300 transition-colors">OK</button>
                </div>
            </div>

            <header class="text-center w-full">
                <h1 class="text-4xl font-bold text-stone-800">Zjazd Przyjaciół po Latach</h1>
                <p class="text-lg text-stone-600 mt-2">Interaktywny planer, który pomoże nam wybrać idealne miejsce na spotkanie!</p>
            </header>
        </div>

        <div class="bg-white p-6 rounded-2xl shadow-lg mb-8">
            <h2 class="text-2xl font-semibold text-center text-stone-700 mb-4">Mapa Propozycji</h2>
            <p class="text-center text-stone-500 mb-6">Polska została podzielona na 9 regionów. Kliknij na dowolny z nich, aby zobaczyć dwie propozycje hoteli, które spełniają nasze kryteria: mogą pomieścić 12 osób, oferują dobre jedzenie i miłą atmosferę. Każda propozycja zawiera wycenę weekendowego pobytu.</p>
            <div id="region-grid" class="grid grid-cols-3 gap-2 sm:gap-4">
                </div>
        </div>

        <div id="details-container">
               <div class="text-center p-8 bg-white rounded-2xl shadow-lg">
                 <svg class="mx-auto h-12 w-12 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                     <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                     <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 100-6 3 3 0 000 6z" />
                 </svg>
                 <h3 class="mt-2 text-xl font-medium text-gray-900">Wybierz region</h3>
                 <p class="mt-1 text-stone-500">Kliknij na mapie, aby zobaczyć szczegóły propozycji.</p>
             </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-2xl shadow-lg">
            <h2 class="text-2xl font-semibold text-center text-stone-700 mb-4">Ankieta Wyboru Regionu</h2>
            <p class="text-center text-stone-500 mb-6">Oddaj swój głos na ulubione regiony (możesz wybrać więcej niż jeden).</p>

            <form id="region-vote-form" class="space-y-4">
                <div class="flex flex-col">
                    <label for="voter-name-region" class="font-medium text-stone-700 mb-1">Twoje imię:</label>
                    <input type="text" id="voter-name-region" class="p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Wprowadź swoje imię" required>
                </div>

                <div class="flex flex-col">
                    <label class="font-medium text-stone-700 mb-1">Wybierz region(y):</label>
                    <div id="vote-region-buttons" class="grid grid-cols-3 gap-2">
                        </div>
                </div>

                <div class="flex items-center justify-between">
                    <button type="submit" id="submit-region-vote-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                        Wyślij Głos
                    </button>
                </div>
                <p id="region-vote-message" class="text-center text-sm font-semibold mt-2"></p>
            </form>

            <form id="add-region-form" class="mt-4 flex flex-col space-y-2">
                <label for="new-region-name" class="font-medium text-stone-700 mb-1">Dodaj nowy region do ankiety:</label>
                <div class="flex space-x-2">
                    <input type="text" id="new-region-name" class="flex-grow p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Nazwa regionu" required>
                    <button type="submit" id="add-region-btn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-200">
                        Dodaj
                    </button>
                </div>
                <p id="add-region-message" class="text-center text-sm font-semibold mt-1"></p>
            </form>

            <div id="region-results-container" class="mt-8">
                <h3 class="text-xl font-semibold text-stone-700 mb-4 text-center">Aktualne Wyniki Głosowania na Region</h3>
                <div id="region-vote-results" class="bg-stone-50 p-4 rounded-lg shadow-inner">
                    <p class="text-center text-stone-500">Brak oddanych głosów. Bądź pierwszy!</p>
                </div>
            </div>

            <div class="mt-6 border-t pt-6 border-stone-200">
                <h4 class="text-lg font-semibold text-stone-700 mb-3">Zresetuj Ankietę</h4>
                <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-2">
                    <input type="password" id="region-reset-code" class="w-full sm:w-1/3 p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400" placeholder="Kod resetujący">
                    <button id="reset-region-btn" class="w-full sm:w-auto bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors duration-200">
                        Zresetuj
                    </button>
                </div>
                <p id="region-reset-message" class="text-center text-sm font-semibold mt-2"></p>
            </div>
        </div>

        <div class="mt-8 bg-white p-6 rounded-2xl shadow-lg">
            <h2 class="text-2xl font-semibold text-center text-stone-700 mb-4">Ankieta Wyboru Terminu</h2>
            <p class="text-center text-stone-500 mb-6">Wybierz weekend(y), który(e) najbardziej Ci odpowiadają na zjazd (możesz wybrać więcej niż jeden).</p>

            <form id="weekend-vote-form" class="space-y-4">
                <div class="flex flex-col">
                    <label for="voter-name-weekend" class="font-medium text-stone-700 mb-1">Twoje imię:</label>
                    <input type="text" id="voter-name-weekend" class="p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Wprowadź swoje imię" required>
                </div>

                <div class="flex flex-col">
                    <label class="font-medium text-stone-700 mb-1">Wybierz termin(y):</label>
                    <div id="vote-weekend-buttons" class="grid grid-cols-2 gap-2 sm:grid-cols-3">
                        </div>
                </div>

                <div class="flex items-center justify-between">
                    <button type="submit" id="submit-weekend-vote-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                        Wyślij Głos
                    </button>
                </div>
                <p id="weekend-vote-message" class="text-center text-sm font-semibold mt-2"></p>
            </form>

            <form id="add-weekend-form" class="mt-4 flex flex-col space-y-2">
                <label for="new-weekend-name" class="font-medium text-stone-700 mb-1">Dodaj nowy termin do ankiety:</label>
                <div class="flex space-x-2">
                    <input type="text" id="new-weekend-name" class="flex-grow p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="np. 1-3 Grudnia" required>
                    <button type="submit" id="add-weekend-btn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-200">
                        Dodaj
                    </button>
                </div>
                <p id="add-weekend-message" class="text-center text-sm font-semibold mt-1"></p>
            </form>

            <div id="weekend-results-container" class="mt-8">
                <h3 class="text-xl font-semibold text-stone-700 mb-4 text-center">Aktualne Wyniki Głosowania na Termin</h3>
                <div id="weekend-vote-results" class="bg-stone-50 p-4 rounded-lg shadow-inner">
                    <p class="text-center text-stone-500">Brak oddanych głosów. Bądź pierwszy!</p>
                </div>
            </div>

            <div class="mt-6 border-t pt-6 border-stone-200">
                <h4 class="text-lg font-semibold text-stone-700 mb-3">Zresetuj Ankietę</h4>
                <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-2">
                    <input type="password" id="weekend-reset-code" class="w-full sm:w-1/3 p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400" placeholder="Kod resetujący">
                    <button id="reset-weekend-btn" class="w-full sm:w-auto bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors duration-200">
                        Zresetuj
                    </button>
                </div>
                <p id="weekend-reset-message" class="text-center text-sm font-semibold mt-2"></p>
            </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-2xl shadow-lg">
            <h2 class="text-2xl font-semibold text-center text-stone-700 mb-4">Ankieta Wyboru Ceny</h2>
            <p class="text-center text-stone-500 mb-6">Oddaj swój głos na preferowane przedziały cenowe za nocleg (za osobę, za dobę) (możesz wybrać więcej niż jeden).</p>

            <form id="price-vote-form" class="space-y-4">
                <div class="flex flex-col">
                    <label for="voter-name-price" class="font-medium text-stone-700 mb-1">Twoje imię:</label>
                    <input type="text" id="voter-name-price" class="p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Wprowadź swoje imię" required>
                </div>
                
                <div class="flex flex-col">
                    <label class="font-medium text-stone-700 mb-1">Wybierz przedział(y) cenowe:</label>
                    <div id="vote-price-buttons" class="grid grid-cols-2 sm:grid-cols-4 gap-2">
                        </div>
                </div>

                <div class="flex items-center justify-between">
                    <button type="submit" id="submit-price-vote-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                        Wyślij Głos
                    </button>
                </div>
                <p id="price-vote-message" class="text-center text-sm font-semibold mt-2"></p>
            </form>

            <form id="add-price-form" class="mt-4 flex flex-col space-y-2">
                <label for="new-price-name" class="font-medium text-stone-700 mb-1">Dodaj nowy przedział cenowy do ankiety:</label>
                <div class="flex space-x-2">
                    <input type="text" id="new-price-name" class="flex-grow p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="np. 350-400 zł" required>
                    <button type="submit" id="add-price-btn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-200">
                        Dodaj
                    </button>
                </div>
                <p id="add-price-message" class="text-center text-sm font-semibold mt-1"></p>
            </form>

            <div id="price-results-container" class="mt-8">
                <h3 class="text-xl font-semibold text-stone-700 mb-4 text-center">Aktualne Wyniki Głosowania na Cenę</h3>
                <div id="price-vote-results" class="bg-stone-50 p-4 rounded-lg shadow-inner">
                    <p class="text-center text-stone-500">Brak oddanych głosów. Bądź pierwszy!</p>
                </div>
            </div>

            <div class="mt-6 border-t pt-6 border-stone-200">
                <h4 class="text-lg font-semibold text-stone-700 mb-3">Zresetuj Ankietę</h4>
                <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-2">
                    <input type="password" id="price-reset-code" class="w-full sm:w-1/3 p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400" placeholder="Kod resetujący">
                    <button id="reset-price-btn" class="w-full sm:w-auto bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors duration-200">
                        Zresetuj
                    </button>
                </div>
                <p id="price-reset-message" class="text-center text-sm font-semibold mt-2"></p>
            </div>
        </div>

        <div class="mt-8 bg-white p-6 rounded-2xl shadow-lg">
            <h2 class="text-2xl font-semibold text-center text-stone-700 mb-4">Ankieta Wyboru Typu Miejscówki</h2>
            <p class="text-center text-stone-500 mb-6">Wybierz typ miejsca, w którym chcielibyście się zatrzymać (możesz wybrać więcej niż jeden).</p>

            <form id="type-vote-form" class="space-y-4">
                <div class="flex flex-col">
                    <label for="voter-name-type" class="font-medium text-stone-700 mb-1">Twoje imię:</label>
                    <input type="text" id="voter-name-type" class="p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="Wprowadź swoje imię" required>
                </div>
                
                <div class="flex flex-col">
                    <label class="font-medium text-stone-700 mb-1">Wybierz typ(y):</label>
                    <div id="vote-type-buttons" class="grid grid-cols-2 sm:grid-cols-3 gap-2">
                        </div>
                </div>

                <div class="flex items-center justify-between">
                    <button type="submit" id="submit-type-vote-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors duration-200">
                        Wyślij Głos
                    </button>
                </div>
                <p id="type-vote-message" class="text-center text-sm font-semibold mt-2"></p>
            </form>

            <form id="add-type-form" class="mt-4 flex flex-col space-y-2">
                <label for="new-type-name" class="font-medium text-stone-700 mb-1">Dodaj nowy typ do ankiety:</label>
                <div class="flex space-x-2">
                    <input type="text" id="new-type-name" class="flex-grow p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="np. Chatka w górach" required>
                    <button type="submit" id="add-type-btn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-200">
                        Dodaj
                    </button>
                </div>
                <p id="add-type-message" class="text-center text-sm font-semibold mt-1"></p>
            </form>

            <div id="type-results-container" class="mt-8">
                <h3 class="text-xl font-semibold text-stone-700 mb-4 text-center">Aktualne Wyniki Głosowania na Typ Miejscówki</h3>
                <div id="type-vote-results" class="bg-stone-50 p-4 rounded-lg shadow-inner">
                    <p class="text-center text-stone-500">Brak oddanych głosów. Bądź pierwszy!</p>
                </div>
            </div>

            <div class="mt-6 border-t pt-6 border-stone-200">
                <h4 class="text-lg font-semibold text-stone-700 mb-3">Zresetuj Ankietę</h4>
                <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-2">
                    <input type="password" id="type-reset-code" class="w-full sm:w-1/3 p-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400" placeholder="Kod resetujący">
                    <button id="reset-type-btn" class="w-full sm:w-auto bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors duration-200">
                        Zresetuj
                    </button>
                </div>
                <p id="type-reset-message" class="text-center text-sm font-semibold mt-2"></p>
            </div>
        </div>
        
        <div id="stats-container" class="mt-8 bg-gray-800 text-white p-6 rounded-2xl shadow-lg hidden">
            <h2 class="text-2xl font-semibold text-center text-gray-200 mb-4">Statystyki Odwiedzin</h2>
            <div class="text-center">
                <p class="text-lg">Ta strona została odwiedzona <span id="visit-count" class="font-bold text-blue-400">0</span> razy.</p>
                <p class="text-sm text-gray-400 mt-2">Powyższe dane są zapisywane w pamięci przeglądarki (localStorage) i liczą odwiedziny na tym konkretnym urządzeniu.</p>
            </div>
        </div>
    </div>
    
    <script>
        // Data for regions, hotels, dates, and prices
        const hotelData = {
            'nw': { name: 'Północny-Zachód', hotels: [
                { name: 'Hotel Orle Gniazdo, Szczyrk', desc: 'Położony w sercu Beskidów...', priceSingle: 'ok. 9 600 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 7 800 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 325 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Orle+Gniazdo+Szczyrk' },
                { name: 'Pałac Ciekocinko Hotel Resort & Wellness', desc: 'Luksusowy wypoczynek w butikowym hotelu...', priceSingle: 'ok. 11 500 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 9 200 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 383 PLN', googleMapsLink: 'https://www.google.com/maps/place/Pa%C5%82ac+Ciekocinko' }
            ]},
            'n': { name: 'Północ', hotels: [
                { name: 'Hotel Aubrecht, Kaszuby', desc: 'Elegancki hotel nad jeziorem...', priceSingle: 'ok. 10 200 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 8 400 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 350 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Aubrecht' },
                { name: 'Hotel Mikołajki, Mazury', desc: 'Położony na Ptasiej Wyspie...', priceSingle: 'ok. 10 800 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 8 900 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 371 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Miko%C5%82ajki+Leisure+%26+SPA' }
            ]},
            'ne': { name: 'Północny-Wschód', hotels: [
                { name: 'Hotel Żubrówka, Białowieża', desc: 'Bezpośrednie sąsiedztwo Puszczy Białowieskiej...', priceSingle: 'ok. 8 800 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 7 100 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 296 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+%C5%BBubr%C3%B3wka' },
                { name: 'Dwór Kaliszki, Mazury', desc: 'Zabytkowy dworek z duszą...', priceSingle: 'ok. 9 300 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 7 500 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 313 PLN', googleMapsLink: 'https://www.google.com/maps/place/Dw%C3%B3r+Kaliszki' }
            ]},
            'w': { name: 'Zachód', hotels: [
                { name: 'Pałac Mierzęcin Wellness & Wine Resort', desc: 'Połączenie luksusowego spa z winnicą...', priceSingle: 'ok. 11 000 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 9 000 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 375 PLN', googleMapsLink: 'https://www.google.com/maps/place/Pa%C5%82ac+Mierzecin+Wellness+%26+Wine+Resort' },
                { name: 'Hotel Remes, Opalenica', desc: 'Nowoczesny kompleks sportowo-rekreacyjny...', priceSingle: 'ok. 9 500 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 7 700 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 321 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Remes' }
            ]},
            'c': { name: 'Centrum', hotels: [
                { name: 'Hotel BoniFaCio Spa & Sport Resort', desc: 'Położony wśród lasów niedaleko Warszawy...', priceSingle: 'ok. 10 500 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 8 600 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 358 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+BoniFaCio+SPA+%26+SPORT+Resort' },
                { name: 'Fabryka Wełny Hotel & Spa, Pabianice', desc: 'Unikalny hotel w zrewitalizowanych wnętrzach fabrycznych...', priceSingle: 'ok. 8 500 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 6 900 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 288 PLN', googleMapsLink: 'https://www.google.com/maps/place/Fabryka+We%C5%82ny+Hotel+%26+Spa' }
            ]},
            'e': { name: 'Wschód', hotels: [
                { name: 'Hotel Król Kazimierz, Kazimierz Dolny', desc: 'Stylowy hotel z widokiem na Wisłę...', priceSingle: 'ok. 9 800 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 8 000 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 333 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Krol+Kazimierz' },
                { name: 'Siedlisko Sobibór, Polesie', desc: 'Kameralne miejsce w sercu Poleskiego Parku Narodowego...', priceSingle: 'ok. 8 200 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 6 600 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 275 PLN', googleMapsLink: 'https://www.google.com/maps/place/Siedlisko+Sobib%C3%B3r' }
            ]},
            'sw': { name: 'Południowy-Zachód', hotels: [
                { name: 'Zamek Kliczków', desc: 'Historyczny zamek otoczony fosą...', priceSingle: 'ok. 10 100 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 8 300 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 346 PLN', googleMapsLink: 'https://www.google.com/maps/place/Zamek+Kliczk%C3%B3w' },
                { name: 'Hotel Polanica Resort & Spa, Polanica-Zdrój', desc: 'Nowoczesny obiekt w znanym uzdrowisku...', priceSingle: 'ok. 9 100 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 7 400 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 308 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Polanica+Resort+%26+Spa' }
            ]},
            's': { name: 'Południe', hotels: [
                { name: 'Hotel Aries & Spa, Zakopane', desc: 'Luksusowy hotel w samym sercu Krupówek...', priceSingle: 'ok. 12 000 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 9 800 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 408 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Aries+%26+Spa+Zakopane' },
                { name: 'Poziom 511 Design Hotel & Spa, Jura', desc: 'Nowoczesny hotel wkomponowany w skały...', priceSingle: 'ok. 10 700 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 8 800 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 367 PLN', googleMapsLink: 'https://www.google.com/maps/place/Poziom+511+Design+Hotel+%26+Spa' }
            ]},
            'se': { name: 'Południowy-Wschód', hotels: [
                { name: 'Hotel Arłamów, Bieszczady', desc: 'Ogromny kompleks z niezliczonymi atrakcjami...', priceSingle: 'ok. 11 200 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 9 100 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 379 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Ar%C5%82am%C3%B3w' },
                { name: 'Hotel Bristol Tradition & Luxury, Rzeszów', desc: 'Elegancki hotel w centrum Rzeszowa...', priceSingle: 'ok. 8 900 PLN (12 pokoi 1-os.)', priceDouble: 'ok. 7 200 PLN (6 pokoi 2-os.)', pricePerPerson: 'ok. 300 PLN', googleMapsLink: 'https://www.google.com/maps/place/Hotel+Bristol+Tradition+%26+Luxury' }
            ]}
        };
        
        const RESET_CODE = '632';

        // Elementy DOM
        const gridContainer = document.getElementById('region-grid');
        const detailsContainer = document.getElementById('details-container');
        
        const regionVoteForm = document.getElementById('region-vote-form');
        const voteRegionButtonsContainer = document.getElementById('vote-region-buttons');
        const addRegionForm = document.getElementById('add-region-form');
        const regionVoteMessageEl = document.getElementById('region-vote-message');
        const addRegionMessageEl = document.getElementById('add-region-message');
        const regionVoteResultsEl = document.getElementById('region-vote-results');
        const resetRegionBtn = document.getElementById('reset-region-btn');
        const regionResetCodeInput = document.getElementById('region-reset-code');
        const regionResetMessageEl = document.getElementById('region-reset-message');

        const weekendVoteForm = document.getElementById('weekend-vote-form');
        const voteWeekendButtonsContainer = document.getElementById('vote-weekend-buttons');
        const addWeekendForm = document.getElementById('add-weekend-form');
        const weekendVoteMessageEl = document.getElementById('weekend-vote-message');
        const addWeekendMessageEl = document.getElementById('add-weekend-message');
        const weekendVoteResultsEl = document.getElementById('weekend-vote-results');
        const resetWeekendBtn = document.getElementById('reset-weekend-btn');
        const weekendResetCodeInput = document.getElementById('weekend-reset-code');
        const weekendResetMessageEl = document.getElementById('weekend-reset-message');
        
        const priceVoteForm = document.getElementById('price-vote-form');
        const votePriceButtonsContainer = document.getElementById('vote-price-buttons');
        const addPriceForm = document.getElementById('add-price-form');
        const priceVoteMessageEl = document.getElementById('price-vote-message');
        const addPriceMessageEl = document.getElementById('add-price-message');
        const priceVoteResultsEl = document.getElementById('price-vote-results');
        const resetPriceBtn = document.getElementById('reset-price-btn');
        const priceResetCodeInput = document.getElementById('price-reset-code');
        const priceResetMessageEl = document.getElementById('price-reset-message');

        const typeVoteForm = document.getElementById('type-vote-form');
        const voteTypeButtonsContainer = document.getElementById('vote-type-buttons');
        const addTypeForm = document.getElementById('add-type-form');
        const typeVoteMessageEl = document.getElementById('type-vote-message');
        const addTypeMessageEl = document.getElementById('add-type-message');
        const typeVoteResultsEl = document.getElementById('type-vote-results');
        const resetTypeBtn = document.getElementById('reset-type-btn');
        const typeResetCodeInput = document.getElementById('type-reset-code');
        const typeResetMessageEl = document.getElementById('type-reset-message');
        
        const secretCodeInput = document.getElementById('secret-code-input');
        const showStatsBtn = document.getElementById('show-stats-btn');
        const statsContainer = document.getElementById('stats-container');
        const visitCountEl = document.getElementById('visit-count');

        // Funkcje
        function renderGrid() {
            gridContainer.innerHTML = '';
            Object.keys(hotelData).forEach(key => {
                const region = hotelData[key];
                const button = document.createElement('button');
                button.className = 'region-btn text-sm sm:text-base font-semibold p-4 sm:p-6 rounded-lg border-2 border-stone-200 bg-stone-50 hover:bg-stone-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400';
                button.textContent = region.name;
                button.dataset.regionKey = key;
                gridContainer.appendChild(button);
            });
        }
        
        function renderVoteButtons(options, container, key) {
            container.innerHTML = '';
            if (options && options.length > 0) {
                options.forEach(option => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = `${key}-btn text-sm sm:text-base font-semibold p-2 rounded-lg border-2 border-stone-200 bg-stone-50 hover:bg-blue-600 hover:text-white transition-colors duration-200`;
                    button.textContent = option;
                    button.dataset[key] = option;
                    container.appendChild(button);
                });
            } else {
                container.innerHTML = `<p class="text-center text-stone-500 col-span-3">Brak dostępnych opcji.</p>`;
            }
        }

        function displayRegionDetails(regionKey) {
            const region = hotelData[regionKey];
            const detailsHtml = `
                <div class="bg-white p-6 rounded-2xl shadow-lg fade-in">
                    <h3 class="text-2xl font-bold text-center text-stone-700 mb-4">${region.name}</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        ${region.hotels.map(hotel => `
                            <div class="bg-stone-50 p-4 rounded-lg shadow-inner">
                                <h4 class="text-xl font-semibold text-blue-600">${hotel.name}</h4>
                                <p class="text-sm text-stone-500 mt-1">${hotel.desc}</p>
                                <p class="text-md font-medium mt-3">Koszt weekendu (piątek-niedziela):</p>
                                <ul class="list-disc list-inside mt-1 text-sm text-stone-600">
                                    <li>12 pokoi 1-osobowych: <span class="font-bold">${hotel.priceSingle}</span></li>
                                    <li>6 pokoi 2-osobowych: <span class="font-bold">${hotel.priceDouble}</span></li>
                                    <li>Koszt za osobę/dobę: <span class="font-bold text-red-600">${hotel.pricePerPerson}</span></li>
                                </ul>
                                <a href="${hotel.googleMapsLink}" target="_blank" class="inline-block mt-4 text-blue-500 hover:underline text-sm font-semibold">Zobacz na mapie</a>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            detailsContainer.innerHTML = detailsHtml;
        }

        // FUNKCJE OBSŁUGI FIREBASE
        const pollOptionsRef = database.ref('pollOptions');
        const votesRef = database.ref('votes');

        // Nasłuchiwanie zmian w opcjach ankiet
        pollOptionsRef.on('value', (snapshot) => {
            const pollOptions = snapshot.val() || {};
            const regionOptions = pollOptions.region ? Object.values(pollOptions.region) : Object.values(hotelData).map(region => region.name);
            const weekendOptions = pollOptions.weekend ? Object.values(pollOptions.weekend) : ['3-5 Października', '10-12 Października', '17-19 Października', '24-26 Października', '31 Października-2 Listopada', '7-9 Listopada', '14-16 Listopada', '21-23 Listopada', '28-30 Listopada'];
            const priceOptions = pollOptions.price ? Object.values(pollOptions.price) : ['do 100 zł', '100-200 zł', '200-300 zł', 'powyżej 300 zł'];
            const typeOptions = pollOptions.type ? Object.values(pollOptions.type) : ['Hotel', 'Domek', 'Agroturystyka', 'Namiot', 'Las'];
            
            renderVoteButtons(regionOptions, voteRegionButtonsContainer, 'region');
            renderVoteButtons(weekendOptions, voteWeekendButtonsContainer, 'weekend');
            renderVoteButtons(priceOptions, votePriceButtonsContainer, 'price');
            renderVoteButtons(typeOptions, voteTypeButtonsContainer, 'type');
        });

        // Nasłuchiwanie zmian w głosach
        votesRef.on('value', (snapshot) => {
            const allVotes = snapshot.val() || {};
            updateAllResults(allVotes);
        });

        function updateAllResults(allVotes) {
            updatePollResults(allVotes.region, regionVoteResultsEl);
            updatePollResults(allVotes.weekend, weekendVoteResultsEl);
            updatePollResults(allVotes.price, priceVoteResultsEl);
            updatePollResults(allVotes.type, typeVoteResultsEl);
        }

        function updatePollResults(pollVotes, resultsEl) {
            const counts = {};
            if (pollVotes) {
                Object.values(pollVotes).forEach(vote => {
                    vote.options.forEach(option => {
                        counts[option] = (counts[option] || 0) + 1;
                    });
                });
            }

            resultsEl.innerHTML = '';
            if (Object.keys(counts).length > 0) {
                const sortedResults = Object.entries(counts).sort(([, a], [, b]) => b - a);
                sortedResults.forEach(([option, count]) => {
                    const p = document.createElement('p');
                    p.className = 'text-stone-700';
                    p.innerHTML = `<span class="font-bold">${option}</span>: ${count} głosów`;
                    resultsEl.appendChild(p);
                });
            } else {
                resultsEl.innerHTML = `<p class="text-center text-stone-500">Brak oddanych głosów. Bądź pierwszy!</p>`;
            }
        }
        
        function submitVote(formId, voteType) {
            const form = document.getElementById(formId);
            const voterNameInput = document.getElementById(`voter-name-${voteType}`);
            const messageEl = document.getElementById(`${voteType}-vote-message`);
            const selectedButtons = document.querySelectorAll(`.${voteType}-btn.active`);

            const voterName = voterNameInput.value.trim();
            const selectedOptions = Array.from(selectedButtons).map(btn => btn.dataset[voteType]);

            if (voterName === "" || selectedOptions.length === 0) {
                messageEl.textContent = "Proszę podać imię i wybrać opcję.";
                messageEl.className = 'text-center text-sm font-semibold mt-2 text-red-500';
                return;
            }

            // Zapisz głos w bazie danych Firebase
            votesRef.child(voteType).push().set({
                name: voterName,
                options: selectedOptions,
                timestamp: Date.now()
            }).then(() => {
                messageEl.textContent = "Twój głos został pomyślnie wysłany!";
                messageEl.className = 'text-center text-sm font-semibold mt-2 text-green-500';
                form.reset();
                selectedButtons.forEach(btn => btn.classList.remove('active'));
            }).catch(error => {
                console.error("Błąd podczas wysyłania głosu:", error);
                messageEl.textContent = "Wystąpił błąd. Spróbuj ponownie.";
                messageEl.className = 'text-center text-sm font-semibold mt-2 text-red-500';
            });
        }

        function addOption(formId, inputId, messageId, optionType) {
            const form = document.getElementById(formId);
            const input = document.getElementById(inputId);
            const messageEl = document.getElementById(messageId);
            const newOptionName = input.value.trim();

            if (newOptionName === "") {
                messageEl.textContent = "Wprowadź nazwę opcji.";
                messageEl.className = 'text-center text-sm font-semibold mt-1 text-red-500';
                return;
            }

            // Dodaj nową opcję do bazy danych Firebase
            pollOptionsRef.child(optionType).push().set(newOptionName).then(() => {
                messageEl.textContent = "Nowa opcja została dodana!";
                messageEl.className = 'text-center text-sm font-semibold mt-1 text-green-500';
                form.reset();
            }).catch(error => {
                console.error("Błąd podczas dodawania opcji:", error);
                messageEl.textContent = "Wystąpił błąd. Spróbuj ponownie.";
                messageEl.className = 'text-center text-sm font-semibold mt-1 text-red-500';
            });
        }

        function resetPoll(resetCodeInputId, messageId, pollType) {
            const codeInput = document.getElementById(resetCodeInputId);
            const messageEl = document.getElementById(messageId);

            if (codeInput.value !== RESET_CODE) {
                messageEl.textContent = "Nieprawidłowy kod resetujący.";
                messageEl.className = 'text-center text-sm font-semibold mt-2 text-red-500';
                return;
            }

            // Usuń dane ankiety z bazy danych Firebase
            votesRef.child(pollType).remove().then(() => {
                messageEl.textContent = `Ankieta na temat ${pollType} została zresetowana!`;
                messageEl.className = 'text-center text-sm font-semibold mt-2 text-green-500';
                codeInput.value = '';
            }).catch(error => {
                console.error("Błąd podczas resetowania ankiety:", error);
                messageEl.textContent = "Wystąpił błąd. Spróbuj ponownie.";
                messageEl.className = 'text-center text-sm font-semibold mt-2 text-red-500';
            });
        }

        // Obsługa zdarzeń
        document.addEventListener('DOMContentLoaded', () => {
            renderGrid();
        });

        gridContainer.addEventListener('click', (e) => {
            const btn = e.target.closest('.region-btn');
            if (btn) {
                document.querySelectorAll('.region-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                displayRegionDetails(btn.dataset.regionKey);
            }
        });

        function setupVoteButtonHandlers(container, type) {
            container.addEventListener('click', (e) => {
                const btn = e.target.closest(`.${type}-btn`);
                if (btn) {
                    btn.classList.toggle('active');
                }
            });
        }

        setupVoteButtonHandlers(voteRegionButtonsContainer, 'region');
        setupVoteButtonHandlers(voteWeekendButtonsContainer, 'weekend');
        setupVoteButtonHandlers(votePriceButtonsContainer, 'price');
        setupVoteButtonHandlers(voteTypeButtonsContainer, 'type');

        regionVoteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            submitVote('region-vote-form', 'region');
        });

        addRegionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('add-region-form', 'new-region-name', 'add-region-message', 'region');
        });

        resetRegionBtn.addEventListener('click', () => {
            resetPoll('region-reset-code', 'region-reset-message', 'region');
        });

        weekendVoteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            submitVote('weekend-vote-form', 'weekend');
        });

        addWeekendForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('add-weekend-form', 'new-weekend-name', 'add-weekend-message', 'weekend');
        });

        resetWeekendBtn.addEventListener('click', () => {
            resetPoll('weekend-reset-code', 'weekend-reset-message', 'weekend');
        });

        priceVoteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            submitVote('price-vote-form', 'price');
        });

        addPriceForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('add-price-form', 'new-price-name', 'add-price-message', 'price');
        });

        resetPriceBtn.addEventListener('click', () => {
            resetPoll('price-reset-code', 'price-reset-message', 'price');
        });

        typeVoteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            submitVote('type-vote-form', 'type');
        });

        addTypeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addOption('add-type-form', 'new-type-name', 'add-type-message', 'type');
        });

        resetTypeBtn.addEventListener('click', () => {
            resetPoll('type-reset-code', 'type-reset-message', 'type');
        });

        // Obsługa statystyk (nadal na localStorage)
        showStatsBtn.addEventListener('click', () => {
            const secretCode = secretCodeInput.value;
            if (secretCode === RESET_CODE) {
                statsContainer.classList.remove('hidden');
                let visitCount = parseInt(localStorage.getItem('visitCount') || 0);
                visitCountEl.textContent = visitCount;
            } else {
                alert("Nieprawidłowy kod.");
            }
        });
        let currentVisitCount = parseInt(localStorage.getItem('visitCount') || 0);
        currentVisitCount++;
        localStorage.setItem('visitCount', currentVisitCount);
    </script>
</body>
</html>